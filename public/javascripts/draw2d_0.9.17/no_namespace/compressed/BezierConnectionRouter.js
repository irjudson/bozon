/**
This notice must be untouched at all times.
This is the COMPRESSED version of Draw2D
WebSite: http://www.draw2d.org
Copyright: 2006 Andreas Herz. All rights reserved.
Created: 5.11.2006 by Andreas Herz (Web: http://www.freegroup.de )
LICENSE: LGPL
**/

BezierConnectionRouter=function(_8e1){if(!_8e1){this.cheapRouter=new ManhattanConnectionRouter();}else{this.cheapRouter=null;}this.iteration=5;};BezierConnectionRouter.prototype=new ConnectionRouter;BezierConnectionRouter.prototype.type="BezierConnectionRouter";BezierConnectionRouter.prototype.drawBezier=function(_8e2,_8e3,t,iter){var n=_8e2.length-1;var q=new Array();var _8e8=n+1;for(var i=0;i<_8e8;i++){q[i]=new Array();q[i][0]=_8e2[i];}for(var j=1;j<=n;j++){for(var i=0;i<=(n-j);i++){q[i][j]=new Point((1-t)*q[i][j-1].x+t*q[i+1][j-1].x,(1-t)*q[i][j-1].y+t*q[i+1][j-1].y);}}var c1=new Array();var c2=new Array();for(var i=0;i<n+1;i++){c1[i]=q[0][i];c2[i]=q[i][n-i];}if(iter>=0){this.drawBezier(c1,_8e3,t,--iter);this.drawBezier(c2,_8e3,t,--iter);}else{for(var i=0;i<n;i++){_8e3.push(q[i][n-i]);}}};BezierConnectionRouter.prototype.route=function(conn){if(this.cheapRouter!=null&&(conn.getSource().getParent().isMoving==true||conn.getTarget().getParent().isMoving==true)){this.cheapRouter.route(conn);return;}var _8ee=new Array();var _8ef=conn.getStartPoint();var toPt=conn.getEndPoint();this._route(_8ee,conn,toPt,this.getEndDirection(conn),_8ef,this.getStartDirection(conn));var _8f1=new Array();this.drawBezier(_8ee,_8f1,0.5,this.iteration);for(var i=0;i<_8f1.length;i++){conn.addPoint(_8f1[i]);}conn.addPoint(toPt);};BezierConnectionRouter.prototype._route=function(_8f3,conn,_8f5,_8f6,toPt,_8f8){var TOL=0.1;var _8fa=0.01;var _8fb=90;var UP=0;var _8fd=1;var DOWN=2;var LEFT=3;var _900=_8f5.x-toPt.x;var _901=_8f5.y-toPt.y;var _902;var dir;if(((_900*_900)<(_8fa))&&((_901*_901)<(_8fa))){_8f3.push(new Point(toPt.x,toPt.y));return;}if(_8f6==LEFT){if((_900>0)&&((_901*_901)<TOL)&&(_8f8==_8fd)){_902=toPt;dir=_8f8;}else{if(_900<0){_902=new Point(_8f5.x-_8fb,_8f5.y);}else{if(((_901>0)&&(_8f8==DOWN))||((_901<0)&&(_8f8==UP))){_902=new Point(toPt.x,_8f5.y);}else{if(_8f6==_8f8){var pos=Math.min(_8f5.x,toPt.x)-_8fb;_902=new Point(pos,_8f5.y);}else{_902=new Point(_8f5.x-(_900/2),_8f5.y);}}}if(_901>0){dir=UP;}else{dir=DOWN;}}}else{if(_8f6==_8fd){if((_900<0)&&((_901*_901)<TOL)&&(_8f8==LEFT)){_902=toPt;dir=_8f8;}else{if(_900>0){_902=new Point(_8f5.x+_8fb,_8f5.y);}else{if(((_901>0)&&(_8f8==DOWN))||((_901<0)&&(_8f8==UP))){_902=new Point(toPt.x,_8f5.y);}else{if(_8f6==_8f8){var pos=Math.max(_8f5.x,toPt.x)+_8fb;_902=new Point(pos,_8f5.y);}else{_902=new Point(_8f5.x-(_900/2),_8f5.y);}}}if(_901>0){dir=UP;}else{dir=DOWN;}}}else{if(_8f6==DOWN){if(((_900*_900)<TOL)&&(_901<0)&&(_8f8==UP)){_902=toPt;dir=_8f8;}else{if(_901>0){_902=new Point(_8f5.x,_8f5.y+_8fb);}else{if(((_900>0)&&(_8f8==_8fd))||((_900<0)&&(_8f8==LEFT))){_902=new Point(_8f5.x,toPt.y);}else{if(_8f6==_8f8){var pos=Math.max(_8f5.y,toPt.y)+_8fb;_902=new Point(_8f5.x,pos);}else{_902=new Point(_8f5.x,_8f5.y-(_901/2));}}}if(_900>0){dir=LEFT;}else{dir=_8fd;}}}else{if(_8f6==UP){if(((_900*_900)<TOL)&&(_901>0)&&(_8f8==DOWN)){_902=toPt;dir=_8f8;}else{if(_901<0){_902=new Point(_8f5.x,_8f5.y-_8fb);}else{if(((_900>0)&&(_8f8==_8fd))||((_900<0)&&(_8f8==LEFT))){_902=new Point(_8f5.x,toPt.y);}else{if(_8f6==_8f8){var pos=Math.min(_8f5.y,toPt.y)-_8fb;_902=new Point(_8f5.x,pos);}else{_902=new Point(_8f5.x,_8f5.y-(_901/2));}}}if(_900>0){dir=LEFT;}else{dir=_8fd;}}}}}}this._route(_8f3,conn,_902,dir,toPt,_8f8);_8f3.push(_8f5);};